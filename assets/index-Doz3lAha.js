import{U as d}from"./yamlWorker-Cx1HNfLM.js";import"./monaco-D_himP8N.js";function x(e,r,t){const n=new Map,i=s=>{const a=s.getLanguageId();return Array.isArray(r)?r.includes(a):r===a},u=async s=>{const a=s.getVersionId(),m=await t.provideMarkerData(s);!s.isDisposed()&&a===s.getVersionId()&&i(s)&&e.editor.setModelMarkers(s,t.owner,m??[])},o=s=>{if(!i(s))return;let a;const m=s.onDidChangeContent(()=>{clearTimeout(a),a=setTimeout(()=>{u(s)},500)});n.set(s,{dispose(){clearTimeout(a),m.dispose()}}),u(s)},f=s=>{e.editor.setModelMarkers(s,t.owner,[]);const a=n.get(s);a&&(a.dispose(),n.delete(s))},g=e.editor.onDidCreateModel(o),p=e.editor.onWillDisposeModel(s=>{var a;f(s),(a=t.doReset)==null||a.call(t,s)}),w=e.editor.onDidChangeModelLanguage(({model:s})=>{var a;f(s),o(s),(a=t.doReset)==null||a.call(t,s)});for(const s of e.editor.getModels())o(s);return{dispose(){for(const s of n.keys())f(s);g.dispose(),p.dispose(),w.dispose()},async revalidate(){await Promise.all(e.editor.getModels().map(u))}}}function k(e,r){let{createData:t,interval:n=3e4,label:i,moduleId:u,stopWhenIdleFor:o=12e4}=r,f,g=0,p=!1;const w=()=>{f&&(f.dispose(),f=void 0)},s=setInterval(()=>{if(!f)return;Date.now()-g>o&&w()},n);return{dispose(){p=!0,clearInterval(s),w()},getWorker(...a){if(p)throw new Error("Worker manager has been disposed");return g=Date.now(),f||(f=e.editor.createWebWorker({createData:t,label:i,moduleId:u})),f.withSyncedResources(a)},updateCreateData(a){t=a,w()}}}function S(e){return e===8?1:e===4?2:e===2?3:4}function W(e){return e===1?8:e===2?4:e===3?2:1}function L(e){return e}function E(e){return e}function v(e){return{start:{line:e.startLineNumber-1,character:e.startColumn-1},end:{line:e.endLineNumber-1,character:e.endColumn-1}}}function l(e){return{startLineNumber:e.start.line+1,startColumn:e.start.character+1,endLineNumber:e.end.line+1,endColumn:e.end.character+1}}function N(e){return{location:{range:v(e),uri:String(e.resource)},message:e.message}}function _(e){return{...l(e.location.range),message:e.message,resource:d.parse(e.location.uri)}}function U(e){const r={message:e.message,range:v(e),severity:S(e.severity)};return typeof e.code=="string"?r.code=e.code:e.code!=null&&(r.code=e.code.value,r.codeDescription={href:String(e.code.target)}),e.relatedInformation&&(r.relatedInformation=e.relatedInformation.map(N)),e.tags&&(r.tags=e.tags.map(L)),e.source!=null&&(r.source=e.source),r}function D(e,r){var t;const n={...l(e.range),message:e.message,severity:e.severity?W(e.severity):(t=void 0)!==null&&t!==void 0?t:8};return e.code!=null&&(n.code=e.codeDescription==null?String(e.code):{value:String(e.code),target:d.parse(e.codeDescription.href)}),e.relatedInformation&&(n.relatedInformation=e.relatedInformation.map(_)),e.tags&&(n.tags=e.tags.map(E)),e.source!=null&&(n.source=e.source),n}function y(e){return{range:l(e.range),text:e.newText}}function F(e){const r={};return e.ignoreIfExists!=null&&(r.ignoreIfExists=e.ignoreIfExists),e.ignoreIfNotExists!=null&&(r.ignoreIfNotExists=e.ignoreIfNotExists),e.overwrite!=null&&(r.overwrite=e.overwrite),e.recursive!=null&&(r.recursive=e.recursive),r}function I(e){const r=e.kind==="create"?{newResource:d.parse(e.uri)}:e.kind==="delete"?{oldResource:d.parse(e.uri)}:{oldResource:d.parse(e.oldUri),newResource:d.parse(e.newUri)};return e.options&&(r.options=F(e.options)),r}function T(e,r,t){return{resource:d.parse(r),versionId:t,textEdit:y(e)}}function H(e){var r;const t=[];if(e.changes)for(const[n,i]of Object.entries(e.changes))for(const u of i)t.push(T(u,n));if(e.documentChanges)for(const n of e.documentChanges)if("textDocument"in n)for(const i of n.edits)t.push(T(i,n.textDocument.uri,(r=n.textDocument.version)!==null&&r!==void 0?r:void 0));else t.push(I(n));return{edits:t}}function V(e,r){const t={title:e.title,isPreferred:e.isPreferred};return e.diagnostics&&(t.diagnostics=e.diagnostics.map(n=>D(n))),e.disabled&&(t.disabled=e.disabled.reason),e.edit&&(t.edit=H(e.edit)),e.isPreferred!=null&&(t.isPreferred=e.isPreferred),e.kind&&(t.kind=e.kind),t}function b(e){const r={diagnostics:e.markers.map(U),triggerKind:e.trigger};return e.only!=null&&(r.only=[e.only]),r}function O(e){const r={title:e.title,id:e.command};return e.arguments&&(r.arguments=e.arguments),r}function Y(e){return e===1?18:e===2?0:e===3?1:e===4?2:e===5?3:e===6?4:e===7?5:e===8?7:e===9?8:e===10?9:e===11?12:e===12?13:e===13?15:e===14?17:e===15?27:e===16?19:e===17?20:e===18?21:e===19?23:e===20?16:e===21?14:e===22?6:e===23?10:e===24?11:24}function $(e){return e}function P(e){return{value:e.value}}function j(e){return{range:l(e.range),text:e.newText}}function A(e){return"range"in e?l(e.range):"insert"in e&&"replace"in e?{insert:l(e.insert),replace:l(e.replace)}:l(e)}function q(e,r){var t,n,i,u,o;const f=(t=r.itemDefaults)!==null&&t!==void 0?t:{},g=(n=e.textEdit)!==null&&n!==void 0?n:f.editRange,p=(i=e.commitCharacters)!==null&&i!==void 0?i:f.commitCharacters,w=(u=e.insertTextFormat)!==null&&u!==void 0?u:f.insertTextFormat,s=(o=e.insertTextMode)!==null&&o!==void 0?o:f.insertTextMode;let a=e.insertText,m;g?(m=A(g),"newText"in g&&(a=g.newText)):m={...r.range};const c={insertText:a??e.label,kind:e.kind==null?18:Y(e.kind),label:e.label,range:m};return e.additionalTextEdits&&(c.additionalTextEdits=e.additionalTextEdits.map(j)),e.command&&(c.command=O(e.command)),p&&(c.commitCharacters=p),e.detail!=null&&(c.detail=e.detail),typeof e.documentation=="string"?c.documentation=e.documentation:e.documentation&&(c.documentation=P(e.documentation)),e.filterText!=null&&(c.filterText=e.filterText),w===2?c.insertTextRules=4:s===2&&(c.insertTextRules=1),e.preselect!=null&&(c.preselect=e.preselect),e.sortText!=null&&(c.sortText=e.sortText),e.tags&&(c.tags=e.tags.map($)),c}function B(e,r){return{incomplete:!!e.isIncomplete,suggestions:e.items.map(t=>q(t,{range:r.range,itemDefaults:e.itemDefaults}))}}function z(e){return e===1?0:e===2?1:e===3?2:e===4?3:e===5?4:e===6?5:e===7?6:e===8?7:e===9?8:e===10?9:e===11?10:e===12?11:e===13?12:e===14?13:e===15?14:e===16?15:e===17?16:e===18?17:e===19?18:e===20?19:e===21?20:e===22?21:e===23?22:e===24?23:e===25?24:25}function G(e){return e}function R(e){var r,t,n;const i={detail:(r=e.detail)!==null&&r!==void 0?r:"",kind:z(e.kind),name:e.name,range:l(e.range),selectionRange:l(e.selectionRange),tags:(n=(t=e.tags)===null||t===void 0?void 0:t.map(G))!==null&&n!==void 0?n:[]};return e.children&&(i.children=e.children.map(R)),i}function J(e){const r={start:e.startLine+1,end:e.endLine+1};return e.kind!=null&&(r.kind={value:e.kind}),r}function h(e){return typeof e=="string"?{value:e}:{value:`\`\`\`${e.language}
${e.value}
\`\`\``}}function Q(e){return typeof e=="string"||"language"in e?[h(e)]:Array.isArray(e)?e.map(h):[P(e)]}function X(e){const r={contents:Q(e.contents)};return e.range&&(r.range=l(e.range)),r}function C(e){return{character:e.column-1,line:e.lineNumber-1}}function Z(e){const r={range:l(e.range)};return e.tooltip!=null&&(r.tooltip=e.tooltip),e.target!=null&&(r.url=d.parse(e.target)),r}function K(e){const r={range:l(e.targetRange),targetSelectionRange:l(e.targetSelectionRange),uri:d.parse(e.targetUri)};return e.originSelectionRange&&(r.originSelectionRange=l(e.originSelectionRange)),r}function M(e){return{owner:"yaml",async provideMarkerData(r){const n=await(await e(r.uri)).doValidation(String(r.uri));return n==null?void 0:n.map(i=>D(i))},async doReset(r){await(await e(r.uri)).resetSchema(String(r.uri))}}}function ee(e){return{triggerCharacters:[" ",":"],async provideCompletionItems(r,t){const n=r.uri,i=r.getWordUntilPosition(t),o=await(await e(n)).doComplete(String(n),C(t));if(o)return B(o,{range:{startLineNumber:t.lineNumber,startColumn:i.startColumn,endLineNumber:t.lineNumber,endColumn:i.endColumn}})}}}function re(e){return{async provideDefinition(r,t){const n=r.uri,u=await(await e(n)).doDefinition(String(n),C(t));return u==null?void 0:u.map(K)}}}function te(e){return{async provideHover(r,t){const n=r.uri,u=await(await e(n)).doHover(String(n),C(t));if(u)return X(u)}}}function ne(e){return{displayName:"yaml",async provideDocumentSymbols(r){const t=r.uri,i=await(await e(t)).findDocumentSymbols(String(t));return i==null?void 0:i.map(R)}}}function ie(e){return{displayName:"yaml",async provideDocumentFormattingEdits(r){const t=r.uri,i=await(await e(t)).format(String(t));return i==null?void 0:i.map(y)}}}function se(e){return{async provideLinks(r){const t=r.uri,i=await(await e(t)).findLinks(String(t));if(i)return{links:i.map(Z)}}}}function ae(e){return{async provideCodeActions(r,t,n){const i=r.uri,o=await(await e(i)).getCodeAction(String(i),v(t),b(n));if(o)return{actions:o.map(f=>V(f)),dispose(){}}}}}function ue(e){return{async provideFoldingRanges(r){const t=r.uri,i=await(await e(t)).getFoldingRanges(String(t));return i==null?void 0:i.map(J)}}}function le(e,r){const t={completion:!0,customTags:[],enableSchemaRequest:!1,format:!0,isKubernetes:!1,hover:!0,schemas:[],validate:!0,yamlVersion:"1.2",...r};e.languages.register({id:"yaml",extensions:[".yaml",".yml"],aliases:["YAML","yaml","YML","yml"],mimetypes:["application/x-yaml"]});const n=k(e,{label:"yaml",moduleId:"monaco-yaml/yaml.worker",createData:t});let i=x(e,"yaml",M(n.getWorker));const u=[n,e.languages.registerCompletionItemProvider("yaml",ee(n.getWorker)),e.languages.registerHoverProvider("yaml",te(n.getWorker)),e.languages.registerDefinitionProvider("yaml",re(n.getWorker)),e.languages.registerDocumentSymbolProvider("yaml",ne(n.getWorker)),e.languages.registerDocumentFormattingEditProvider("yaml",ie(n.getWorker)),e.languages.registerLinkProvider("yaml",se(n.getWorker)),e.languages.registerCodeActionProvider("yaml",ae(n.getWorker)),e.languages.registerFoldingRangeProvider("yaml",ue(n.getWorker)),e.languages.setLanguageConfiguration("yaml",{comments:{lineComment:"#"},brackets:[["{","}"],["[","]"],["(",")"]],autoClosingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"}],surroundingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"}],onEnterRules:[{beforeText:/:\s*$/,action:{indentAction:e.languages.IndentAction.Indent}}]})];return{dispose(){for(const o of u)o.dispose();i.dispose()},update(o){n.updateCreateData(Object.assign(t,o)),i.dispose(),i=x(e,"yaml",M(n.getWorker))}}}export{le as configureMonacoYaml};
